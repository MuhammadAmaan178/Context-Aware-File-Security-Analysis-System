import re

# EICAR and other signatures
MALWARE_SIGNATURES = [
    b'X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*',
    b'Safe-Test-Malware-Signature',
    b"cmd.exe /c",
    b"powershell -nop -w hidden",
    b"DROP TABLE",
    b"<script>alert('XSS')</script>"
]

def scan_for_malware(content: bytes):
    """
    Lab 08: Signature-based Malware Detection.
    Returns: (bool, str) -> (is_malware, signature_found)
    """
    for sig in MALWARE_SIGNATURES:
        if sig in content:
            return True, sig.decode('utf-8', errors='ignore')
    return False, None
